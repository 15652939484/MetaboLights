metExploreD3.GraphNetwork={zoomListener:"",task:"",delayedInitialisation:function(a){var b=d3.select("#"+a);b.append("svg").attr("width","100%").attr("height","100%").attr("class","D3viz").attr("id","D3viz").style("background-color","#fff");metExploreD3.GraphLink.delayedInitialisation(a);metExploreD3.GraphNode.delayedInitialisation(a)},tick:function(h){if(_metExploreViz.getComparedPanelById(h)!=null||h=="viz"){var s=metExploreD3.getScaleById(h);metExploreD3.GraphLink.tick(h,s);metExploreD3.GraphNode.tick(h);var q=s.getZoomScale();var n=metExploreD3.GraphNetwork.isAnimated(h);var b=_metExploreViz.getSessionById(h);var l=metExploreD3.getGeneralStyle();if(n&&q>0.05&&b.isResizable()){var e=document.getElementById(h).getBoundingClientRect();var a=d3.select("#"+h).select("#D3viz")[0][0].getElementById("graphComponent").getBoundingClientRect();if(e.top>a.top||e.left>a.left||e.bottom<a.bottom||e.right<a.right){var f=b.getD3Data().getNodesLength();var r=3000;if(f<l.getReactionThreshold()||!l.isDisplayedLabelsForOpt()){r=3000}metExploreD3.fixDelay(metExploreD3.GraphNetwork.task,r);var d=s.getZoom();var k=parseInt(d3.select("#"+h).select("#D3viz").style("width"));var j=parseInt(d3.select("#"+h).select("#D3viz").style("height"));var p=0.01*f/100;var o=q-(q*p);d.scale(o);var g=o*k;var m=o*j;var t=(k-g)/2;var c=(j-m)/2;d.translate([t,c]);d.event(d3.select("#"+h).select("#D3viz"));s.setZoomScale(o);s.setXScale(d.x());s.setYScale(d.y())}}}},zoom:function(a){var c=metExploreD3.getScaleById(a);d3.select("#"+a).select("#D3viz").select("#graphComponent").attr("transform","translate("+d3.event.translate+")scale("+d3.event.scale+")");var b=c.getZoom();c.setZoomScale(d3.event.scale);c.setXScale(b.x());c.setYScale(b.y());metExploreD3.GraphLink.tick(a,c)},zoomIn:function(){_MyThisGraphNode.dblClickable=false;var b=this.parentNode.parentNode.id;var h=metExploreD3.getScaleById(b);var d=h.getZoom();var e=_metExploreViz.getSessionById(b);var g=document.getElementById(b).getBoundingClientRect();var f=d3.select("#"+b).select("#D3viz")[0][0].getElementById("graphComponent").getBoundingClientRect();var d=h.getZoom();var c=parseInt(d3.select("#"+b).select("#D3viz").style("width"));var a=parseInt(d3.select("#"+b).select("#D3viz").style("height"));d.scale(h.getZoomScale()*1.1);d.event(d3.select("#"+b).select("#D3viz"));h.setXScale(d.x());h.setYScale(d.y());h.setZoomScale(h.getZoomScale()*1.1);metExploreD3.GraphLink.tick(b,h)},zoomOut:function(){_MyThisGraphNode.dblClickable=false;var b=this.parentNode.parentNode.id;var h=metExploreD3.getScaleById(b);var d=h.getZoom();var e=_metExploreViz.getSessionById(b);var g=document.getElementById(b).getBoundingClientRect();var f=d3.select("#"+b).select("#D3viz")[0][0].getElementById("graphComponent").getBoundingClientRect();var d=h.getZoom();var c=parseInt(d3.select("#"+b).select("#D3viz").style("width"));var a=parseInt(d3.select("#"+b).select("#D3viz").style("height"));d.scale(h.getZoomScale()*0.9);d.event(d3.select("#"+b).select("#D3viz"));h.setXScale(d.x());h.setYScale(d.y());h.setZoomScale(h.getZoomScale()*0.9);metExploreD3.GraphLink.tick(b,h)},animationButtonOn:function(a){d3.select("#"+a).select("#buttonAnim").select("image").remove();d3.select("#"+a).select("#buttonAnim").append("image").attr("xlink:href",document.location.href.split("index.html")[0]+"resources/icons/pause.svg").attr("width","50").attr("height","50").attr("transform","translate(10,10) scale(.5)");metExploreD3.GraphNetwork.setAnimated(a,true)},animationButtonOff:function(a){d3.select("#"+a).select("#buttonAnim").select("image").remove();d3.select("#"+a).select("#buttonAnim").append("image").attr("xlink:href",document.location.href.split("index.html")[0]+"resources/icons/play.svg").attr("width","50").attr("height","50").attr("transform","translate(10,10) scale(.5)");metExploreD3.GraphNetwork.setAnimated(a,false)},play:function(g){var h=_metExploreViz.getSessionsSet();var a=this.parentNode.parentNode.id;var f=_metExploreViz.getSessionById(a);if(f!=undefined){var e=metExploreD3.GraphNetwork.isAnimated(a);if(e=="false"){if(f.isLinked()){for(var b in h){if(h[b].isLinked()){metExploreD3.GraphNetwork.animationButtonOn(h[b].getId())}}var c=_metExploreViz.getSessionById("viz").getForce();c.start()}else{metExploreD3.GraphNetwork.animationButtonOn(a);var c=f.getForce();c.start()}}else{if(f.isLinked()){for(var b in h){if(h[b].isLinked()){metExploreD3.GraphNetwork.animationButtonOff(h[b].getId())}}var c=_metExploreViz.getSessionById("viz").getForce();c.stop()}else{metExploreD3.GraphNetwork.animationButtonOff(a);var c=f.getForce();c.stop()}}}},setLink:function(f){that=this;var a=this.parentNode.parentNode.id;var e=_metExploreViz.getSessionById(a);var b=_metExploreViz.getSessionById("viz");if(e!=undefined){var c=e.getForce();var g=d3.select(this).attr("isLink");d3.select(this).select("image").remove();if(g=="false"){metExploreD3.GraphNetwork.link(that)}else{metExploreD3.GraphNetwork.unLink(that)}}},link:function(d){var a=d.parentNode.parentNode.id;var f=_metExploreViz.getSessionById(a);var c=_metExploreViz.getSessionById("viz");var e=metExploreD3.GraphNetwork.isAnimated("viz");d3.select(d).attr("isLink","true");f.setLinked(true);c.setLinked(true);if(e=="true"){metExploreD3.GraphNetwork.animationButtonOn(a)}else{metExploreD3.GraphNetwork.animationButtonOff(a)}var g=d3.select(d).attr("isLink");d3.select(d).select("image").remove();d3.select(d).append("image").attr("xlink:href",document.location.href.split("index.html")[0]+"resources/icons/link.svg").attr("width","50").attr("height","50").attr("transform","translate(10,50) scale(.5)");if(f!=undefined){if(c.getDuplicatedNodesCount()>0){var b=d3.select("#"+a).select("#D3viz").select("#graphComponent").selectAll("g.node").filter(function(h){return h.getBiologicalType()=="metabolite"});c.getDuplicatedNodes().forEach(function(h){b.filter(function(j){return j.getId()==h}).each(function(j){j.setIsSideCompound(true)})});metExploreD3.GraphNetwork.duplicateSideCompoundsById(c.getDuplicatedNodes(),a);metExploreD3.GraphNetwork.looksLinked();if(f.isLinked()){metExploreD3.GraphNetwork.graphAlignment(a)}}else{metExploreD3.GraphNetwork.graphAlignment(a)}}},unLink:function(b){var a=b.parentNode.parentNode.id;var e=_metExploreViz.getSessionById(a);d3.select(b).append("image").attr("xlink:href",document.location.href.split("index.html")[0]+"resources/icons/unlink.svg").attr("width","50").attr("height","50").attr("transform","translate(10,50) scale(.5)");d3.select(b).attr("isLink","false");e.setLinked(false);metExploreD3.GraphNetwork.looksLinked();var d=metExploreD3.GraphNetwork.isAnimated(a);if(d=="true"){var c=e.getForce();c.start()}},looksLinked:function(){var c=_metExploreViz.getSessionsSet();var b=_metExploreViz.getSessionById("viz");b.setLinked(false);for(var a in c){if(c[a].isLinked()){b.setLinked(true)}}},refreshSvg:function(l){var e=_metExploreViz.getSessionById(l).getD3Data();var o=e.getNodes();metExploreD3.fireEventParentWebSite("refreshCart",o);var m=[];for(var q=0;q<o.length-1;q++){m.push(o[q].name)}m=m.sort();var r=parseInt(metExploreD3.GraphPanel.getHeight(l));var j=parseInt(metExploreD3.GraphPanel.getWidth(l));var t=metExploreD3.getLinkStyle();var p=metExploreD3.getGeneralStyle();var b=d3.layout.force().friction(0.9).gravity(0.06).charge(-150).linkDistance(t.getSize()).size([j,r]);var a=_metExploreViz.getSessionById(l);a.setActivity(true);a.setForce(b);if(l=="viz"){metExploreD3.GraphCaption.drawCaption()}var x=d3.scale.linear().domain([0,j]).range([0,j]);var d=d3.scale.linear().domain([r,0]).range([r,0]);if(a.getScale()==undefined){var g=metExploreD3.GraphNetwork;metExploreD3.GraphNetwork.zoomListener=d3.behavior.zoom().x(x).y(d).scaleExtent([0.01,20]).on("zoom",function(w){var h=_metExploreViz.getSessionById(l);if(h.isActive()){g.zoom(l)}});var v=new Scale(l);v.setScale(x,d,1,1,1,metExploreD3.GraphNetwork.zoomListener.scale(),metExploreD3.GraphNetwork.zoomListener);metExploreD3.setScale(v,l)}else{var g=metExploreD3.GraphNetwork;metExploreD3.GraphNetwork.zoomListener=d3.behavior.zoom().x(x).y(d).scaleExtent([0.01,30]).on("zoom",function(w){var h=_metExploreViz.getSessionById(this.parentNode.id);if(h.isActive()){g.zoom(this.parentNode.id)}});var v=new Scale(l);v.setScale(x,d,1,1,1,metExploreD3.GraphNetwork.zoomListener.scale(),metExploreD3.GraphNetwork.zoomListener);metExploreD3.setScale(v,l)}b.on("start",function(){if(e.getNodes().length>p.getReactionThreshold()&&p.isDisplayedLinksForOpt()){d3.selectAll("line.link").remove()}});b.on("end",function(){var h=metExploreD3.getScaleById(l);if((e.getNodes().length>p.getReactionThreshold()&&p.isDisplayedLinksForOpt())){metExploreD3.GraphLink.reloadLinks(l,e,t,u)}metExploreD3.GraphLink.tick(l,h)});var n=d3.select("#"+l);n.svg=n.select("#D3viz").selectAll("*").remove();_metExploreViz.setLinkedByTypeOfMetabolite(false);var s;var f=false;var c=d3.select("#"+l).select("#D3viz").append("g").datum(function(){return{selected:false,previouslySelected:false}}).attr("id","brush").attr("class","brush").call(d3.svg.brush().x(x).y(d).on("brushstart",function(z){document.addEventListener("mousedown",function(B){if(B.button===1){B.stopPropagation();B.preventDefault();B.stopImmediatePropagation()}});var w=d3.select("#"+l).select("#buttonHand").attr("scrollable");_MyThisGraphNode.activePanel=this.parentNode.parentNode.id;var y=_metExploreViz.getSessionById(_MyThisGraphNode.activePanel);if(d3.event.sourceEvent.button!=1&&w!="true"){if(y!=undefined){if(y.isLinked()){var A=_metExploreViz.getSessionById("viz");if(A!=undefined){var h=A.getForce();if(h!=undefined){h.stop()}}}else{var h=y.getForce();if(h!=undefined){h.stop()}}}f=true;d3.select("#"+l).select("#brush").classed("hide",false);d3.select("#"+l).select("#D3viz").on("mousedown.zoom",null);s=d3.select("#"+l).select("#graphComponent").selectAll("g.node");s.each(function(B){B.previouslySelected=B.isSelected()})}else{var h=y.getForce();if(h!=undefined){h.stop()}d3.select("#"+l).selectAll("#D3viz").style("cursor","all-scroll");d3.selectAll("#brush").classed("hide",true)}}).on("brushend",function(){if(d3.event.sourceEvent.button!=1&&f){var E=d3.event.target.extent();if(E[1][0]-E[0][0]>20||E[1][1]-E[0][1]>20){var B;var E=d3.event.target.extent();var y=metExploreD3.getScaleById(l);var A=y.getZoomScale();var w=metExploreD3.createLoadMask("Selection in progress...",l);if(w!=undefined){metExploreD3.showMask(w);metExploreD3.deferFunction(function(){s.classed("selected",function(L){var K=y.getXScale();var J=y.getYScale();B=(K(E[0][0])<=K(L.x)&&K(L.x)<K(E[1][0]))&&(J(E[0][1])<=J(L.y)&&J(L.y)<J(E[1][1]));if((L.isSelected()==false&&B==true)||(L.isSelected()==true&&B==false&&!L.previouslySelected)){_MyThisGraphNode.selection(L,l)}return B});metExploreD3.hideMask(w);var H=_metExploreViz.getSessionById(_MyThisGraphNode.activePanel);if(H!=undefined){if(H.isLinked()){var I=_metExploreViz.getSessionById("viz");if(I!=undefined){var F=metExploreD3.GraphNetwork.isAnimated(I.getId());if(F=="true"){var G=I.getForce();if(G!=undefined){if((metExploreD3.GraphNetwork.isAnimated(I.getId())=="true")||(metExploreD3.GraphNetwork.isAnimated(I.getId())==null)){G.start()}}}}}else{var G=H.getForce();var F=metExploreD3.GraphNetwork.isAnimated(H.getId());if(F=="true"){var G=H.getForce();if(G!=undefined){if((metExploreD3.GraphNetwork.isAnimated(H.getId())=="true")||(metExploreD3.GraphNetwork.isAnimated(H.getId())==null)){G.start()}}}}}f=false},100)}}}else{var C=_metExploreViz.getSessionById(_MyThisGraphNode.activePanel);if(C!=undefined){if(C.isLinked()){var z=_metExploreViz.getSessionById("viz");if(z!=undefined){var D=metExploreD3.GraphNetwork.isAnimated(z.getId());if(D=="true"){var h=z.getForce();if(h!=undefined){if((metExploreD3.GraphNetwork.isAnimated(z.getId())=="true")||(metExploreD3.GraphNetwork.isAnimated(z.getId())==null)){h.start()}}}}}else{var h=C.getForce();var D=metExploreD3.GraphNetwork.isAnimated(C.getId());if(D=="true"){var h=C.getForce();if(h!=undefined){if(d3.select(metExploreD3.GraphNetwork.isAnimated(C.getId())=="true")||(metExploreD3.GraphNetwork.isAnimated(C.getId())==null)){h.start()}}}}}}d3.event.target.clear();d3.select(this).call(d3.event.target);var y=metExploreD3.getScaleById(l);d3.select("#"+l).selectAll("#D3viz").style("cursor","default");d3.select("#"+l).selectAll("#D3viz").call(y.getZoom()).on("dblclick.zoom",null).on("mousedown",null);d3.event.target.extent();d3.selectAll("#brush").classed("hide",false)}));n.svg=d3.select("#"+l).select("#D3viz").call(metExploreD3.GraphNetwork.zoomListener).on("dblclick.zoom",null).attr("pointer-events","all").append("svg:g").attr("class","graphComponent").attr("id","graphComponent");if(a!=undefined){var b=a.getForce();if(a.isResizable()!=undefined&&a.isResizable()!=false){metExploreD3.GraphNetwork.task.cancel()}a.setResizable(true);metExploreD3.GraphNetwork.task=metExploreD3.createDelayedTask(function(){a.setResizable(false)})}d3.select("#"+l).select("#D3viz").attr("animation",function(){if(a.isAnimated()){return true}else{return false}}).append("svg:g").attr("class","buttonAnim").attr("id","buttonAnim").on("click",metExploreD3.GraphNetwork.play).style("cursor","hand").append("image").attr("xlink:href",function(){if(a.isAnimated()){return document.location.href.split("index.html")[0]+"resources/icons/pause.svg"}else{return document.location.href.split("index.html")[0]+"resources/icons/play.svg"}}).attr("width","50").attr("height","50").attr("transform","translate(10,10) scale(.5)");d3.select("#"+l).select("#D3viz").append("svg:g").attr("class","buttonZoomIn").attr("id","buttonZoomIn").attr("x",(j-60)).attr("y",10).on("click",metExploreD3.GraphNetwork.zoomIn).style("cursor","hand").append("image").attr("xlink:href",document.location.href.split("index.html")[0]+"resources/icons/zoomin.svg").attr("width","50").attr("height","50").style("opacity",0.2).attr("transform","translate("+(j-60)+",10) scale(1)").on("mouseover",function(h){d3.select(this).transition().duration(500).style("opacity",1)}).on("mouseout",function(h){d3.select(this).transition().duration(500).style("opacity",0.2)});d3.select("#"+l).select("#D3viz").append("svg:g").attr("class","buttonZoomOut").attr("id","buttonZoomOut").attr("x",(j-110)).attr("y",10).on("click",metExploreD3.GraphNetwork.zoomOut).style("cursor","hand").append("image").attr("xlink:href",document.location.href.split("index.html")[0]+"resources/icons/zoomout.svg").attr("width","50").attr("height","50").style("opacity",0.2).attr("transform","translate("+(j-110)+",10) scale(1)").on("mouseover",function(h){d3.select(this).transition().duration(500).style("opacity",1)}).on("mouseout",function(h){d3.select(this).transition().duration(500).style("opacity",0.2)});d3.select("#"+l).select("#D3viz").append("svg:g").attr("class","buttonHand").attr("id","buttonHand").attr("x",(j-160)).attr("y",10).attr("scrollable","false").on("click",metExploreD3.GraphNetwork.moveGraph).style("opacity",1).style("cursor","hand").append("image").attr("xlink:href",document.location.href.split("index.html")[0]+"resources/icons/handcursor.svg").attr("width","50").attr("height","50").attr("transform","translate("+(j-160)+",10) scale(1)");d3.select("#"+l).select("#D3viz").select("buttonHand").style("opacity",0);d3.select("#"+l).on("mouseover",function(){d3.select("#"+l).select("#D3viz").select("#buttonZoomOut").transition().duration(500).style("opacity",1);d3.select("#"+l).select("#D3viz").select("#buttonZoomIn").transition().duration(500).style("opacity",1);var w=_metExploreViz.getSessionById(l);if(w.isActive()){var h=d3.select("#"+l).select("#buttonHand").attr("scrollable");if(h=="false"){d3.select("#"+l).select("#D3viz").select("#buttonHand").transition().duration(500).style("opacity",0.2)}else{d3.select("#"+l).select("#D3viz").select("#buttonHand").transition().duration(500).style("opacity",1)}}}).on("mouseout",function(){d3.select("#"+l).select("#D3viz").select("#buttonZoomOut").transition().duration(500).style("opacity",0);d3.select("#"+l).select("#D3viz").select("#buttonZoomIn").transition().duration(500).style("opacity",0);d3.select("#"+l).select("#D3viz").select("#buttonHand").transition().duration(500).style("opacity",0)});if(a.isAnimated()){metExploreD3.GraphNetwork.setAnimated(l,true)}else{metExploreD3.GraphNetwork.setAnimated(l,false)}var t=metExploreD3.getLinkStyle();var u=metExploreD3.getMetaboliteStyle();metExploreD3.GraphLink.refreshLink(l,a,t,u);metExploreD3.GraphNode.refreshNode(l);var k=document.createElement("div");k.id="tooltip2";k.className="tooltip2";k.classList.add("hide");document.getElementById("viz").appendChild(k);if(l!="viz"){d3.select("#"+l).select("#D3viz").append("svg:g").attr("class","buttonLink").attr("id","buttonLink").attr("isLink","false").on("click",metExploreD3.GraphNetwork.setLink).style("cursor","hand").append("image").attr("xlink:href",function(){if(a.isLinked()){return document.location.href.split("index.html")[0]+"resources/icons/unlink.svg"}else{return document.location.href.split("index.html")[0]+"resources/icons/link.svg"}}).attr("width","50").attr("height","50").attr("transform","translate(10,50) scale(.5)")}else{metExploreD3.GraphNetwork.looksLinked();if(a.isLinked()){metExploreD3.GraphNetwork.graphAlignment(l)}}var e=a.getD3Data();var b=a.getForce();b.nodes(e.getNodes()).links(e.getLinks()).on("tick",function(){if(b.alpha()>=0.005){setTimeout(metExploreD3.GraphNetwork.tick(l),0)}});if(a.isAnimated()){b.start()}else{b.start();b.stop();metExploreD3.GraphNetwork.tick(l)}a.setForce(b)},moveGraph:function(){_MyThisGraphNode.dblClickable=false;var a=this.parentNode.parentNode.id;var b=d3.select("#"+a).select("#buttonHand").attr("scrollable");if(b=="false"){d3.select("#"+a).select("#D3viz").select("#buttonHand").transition().duration(500).style("opacity",1);d3.select("#"+a).select("#buttonHand").attr("scrollable",true)}else{d3.select("#"+a).select("#D3viz").select("#buttonHand").transition().duration(500).style("opacity",0.2);d3.select("#"+a).select("#buttonHand").attr("scrollable",false)}},graphAlignment:function(a){var d=_metExploreViz.getSessionById(a);if(a!="viz"){var b=_metExploreViz.getSessionById("viz");d3.select("#"+a).select("#D3viz").select("#graphComponent").selectAll("g.node").each(function(h){var g=this;var f=d3.select(g).select("rect").style("fill");d3.select("#viz").select("#D3viz").select("#graphComponent").selectAll("g.node").each(function(n){if(n.getId()==h.getId()){h.x=n.x;h.y=n.y;if(n.getMappingDatasLength()>0){n.getMappingDatas().forEach(function(o){h.addMappingData(new MappingData(h,o.getMappingName().valueOf(),o.getConditionName().valueOf(),o.getMapValue().valueOf()))})}if(h.selected&&!n.isSelected()){_MyThisGraphNode.selection(n,"viz")}if(!h.selected&&n.isSelected()){_MyThisGraphNode.selection(h,a)}var m=d3.select(this).select("rect."+n.getBiologicalType()).style("fill");if(f!=m){d3.select(g).select("rect."+n.getBiologicalType()).style("fill",m);if(n.getBiologicalType()=="metabolite"){var k=metExploreD3.getMetaboliteStyle()}else{var k=metExploreD3.getReactionStyle();var l=metExploreD3.GraphUtils.chooseTextColor(m);d3.select(g).select("text").style("fill",l)}var j=d3.select(this).select("rect."+n.getBiologicalType()).attr("mapped");if(j>0){d3.select(g).insert("rect",":first-child").attr("class","stroke").attr("width",k.getWidth()+4).attr("height",k.getHeight()+4).attr("rx",k.getRX()).attr("ry",k.getRY()).attr("transform","translate(-"+parseInt(k.getWidth()+4)/2+",-"+parseInt(k.getHeight()+4)/2+")").style("opacity","0.5").style("fill","red")}d.setMappingDataType(b.getMappingDataType());d.setMapped(b.isMapped())}}})});d.setActiveMapping(b.getActiveMapping().valueOf());d.resetColorMapping();b.getColorMappingsSet().forEach(function(f){d.addColorMapping(f.getName().valueOf(),f.getValue().valueOf())});var c=d.getForce();c.stop();var e=metExploreD3.getScaleById(a);metExploreD3.GraphLink.tick(a,e);metExploreD3.GraphNode.tick(a)}},scaledX:function(a,b){var h=metExploreD3.getSessionsSet();var g;if(b=="viz"){var f;for(var d in sessions){if(sessions[d].getId()=="viz"){f=sessions[d].getId()}}var e=parseInt(d3.select("#"+f).select("#D3viz").style("width"));var c=parseInt(d3.select("#viz").select("#D3viz").style("width"));g=(a*e)/c}else{var f;for(var d in sessions){if(sessions[d].getId()=="viz"){f=sessions[d].getId()}}var e=parseInt(d3.select("#"+b).select("#D3viz").style("width"));var c=parseInt(d3.select("#viz").select("#D3viz").style("width"));g=(a*c)/e}return g},scaledY:function(h,a){var g=metExploreD3.getSessionsSet();var b;if(a=="viz"){var f;for(var d in sessions){if(sessions[d].getId()=="viz"){f=sessions[d].getId()}}var e=parseInt(d3.select("#"+f).select("#D3viz").style("height"));var c=parseInt(d3.select("#viz").select("#D3viz").style("height"));b=(h*e)/c}else{var f;for(var d in sessions){if(sessions[d].getId()=="viz"){f=sessions[d].getId()}}var e=parseInt(d3.select("#"+a).select("#D3viz").style("height"));var c=parseInt(d3.select("#viz").select("#D3viz").style("height"));b=(h*c)/e}return Scaled},addLinkInDrawing:function(h,b,g,l,a,c){var k=_metExploreViz.getSessionById(c);var f=k.getD3Data();f.addLink(h,b,g,l,a);var j=metExploreD3.getMetaboliteStyle();var e=metExploreD3.getLinkStyle();var d=k.getForce();link=d3.select("#"+c).select("#graphComponent").selectAll("line").data(d.links(),function(m){return m.source.id+"-"+m.target.id}).enter().insert("line",":first-child").attr("class","link").attr("marker-end",function(m){if(m.interaction=="out"){d3.select("#"+m.interaction).attr("refX",(j.getWidth()+j.getHeight())/2/2+(e.getMarkerWidth())).style("fill",e.getMarkerOutColor()).style("stroke",e.getMarkerStrokeColor()).style("stroke-width",e.getMarkerStrokeWidth());return"url(#"+m.interaction+")"}else{return"none"}}).attr("marker-start",function(m){if(m.interaction=="out"){return"none"}else{d3.select("#"+m.interaction).attr("refX",-((j.getWidth()+j.getHeight())/2/2)).style("fill",e.getMarkerInColor()).style("stroke",e.getMarkerStrokeColor()).style("stroke-width",e.getMarkerStrokeWidth());return"url(#"+m.interaction+")"}}).style("stroke",e.getStrokeColor()).style("opacity",0.5).attr("x1",b.x).attr("y1",b.y).attr("x2",g.x).attr("y2",g.y)},addMetaboliteInDrawing:function(j,n,h,k){var d=n+"-"+h;var a=_metExploreViz.getSessionById(k);var e=a.getD3Data();var b=a.getForce();var t=metExploreD3.getMetaboliteStyle();var r=metExploreD3.getGeneralStyle();var o=d3.behavior.drag().on("dragstart",_MyThisGraphNode.dragstart).on("drag",_MyThisGraphNode.dragmove).on("dragend",_MyThisGraphNode.dragend);var u=metExploreD3.getScaleById(k);metExploreD3.fireEventParentWebSite("sideCompound",j);var c=e.addNode(j.getName(),j.getCompartment(),j.getDbIdentifier(),d,j.getReactionReversibility(),j.getBiologicalType(),false,j.getLabelVisible(),j.getSvg(),j.getSvgWidth(),j.getSvgHeight(),j.getIsSideCompound(),undefined,true,n);if(j.getMappingDatasLength()!=0){j.getMappingDatas().forEach(function(w){e.getNodeById(d).addMappingData(new MappingData(j,w.getMappingName(),w.getConditionName(),w.getMapValue()))})}var q=d3.select("#"+k).select("#D3viz").select("#graphComponent").selectAll("g.node");var m=false;var p=q.filter(function(w){return w.getId()==n});p.each(function(){m=this.getAttribute("mapped")});q=q.data(b.nodes(),function(w){return w.getId()});q.enter().append("svg:g").attr("class","node").attr("duplicated",function(w){return"true"}).call(o).style("fill","white");q.filter(function(w){return w.getBiologicalType()=="metabolite"}).filter(function(w){return w.getId()==d}).style("stroke-opacity",0.5).addNodeForm(t.getWidth()/2,t.getHeight()/2,t.getRX()/2,t.getRY()/2,t.getStrokeColor(),t.getStrokeWidth()/2);q.select("rect").on("mouseenter",function(w){d3.select(this).attr("transform","translate("+w.x+", "+w.y+") scale(2)")}).on("mouseover",function(z){z.fixed=true;if(z.getBiologicalType()=="reaction"){d3.select("#"+k).select("#D3viz").select("#graphComponent").selectAll("line").filter(function(A){return z.getId()==A.getSource().getId()}).style("stroke","green");d3.select("#"+k).select("#D3viz").select("#graphComponent").selectAll("line").filter(function(A){return z.getId()==A.getTarget().getId()}).style("stroke","red")}else{d3.select("#"+k).select("#D3viz").select("#graphComponent").selectAll("line").filter(function(A){return z.getId()==A.getSource().getId()}).style("stroke","red");d3.select("#"+k).select("#D3viz").select("#graphComponent").selectAll("line").filter(function(A){return z.getId()==A.getTarget().getId()}).style("stroke","green")}var y=u.getXScale();var x=u.getYScale();var w="Name: "+z.getName()+"<br/>Biological type: "+z.getBiologicalType()+((z.getCompartment()!=undefined)?"<br/>Compartment: "+z.getCompartment():"")+((z.getDbIdentifier()!=undefined)?"<br/>Database identifier: "+z.getDbIdentifier():"")+((z.getEC()!=undefined)?"<br/>EC number: "+z.getEC():"")+((z.getReactionReversibility()!=undefined)?"<br/>Reaction reversibility: "+z.getReactionReversibility():"")+((z.getIsSideCompound()!=undefined)?"<br/>SideCompound: "+z.getIsSideCompound():"")+((z.getMappingDatasLength()!=0)?((z.getMappingDatasLength()==1)?"<br/>Mapping:<br/><table style='width:100%; margin-left: 30px; padding-right: 30px;'>":"<br/>Mappings:<br/><table style='width:100%; margin-left: 30px; padding-right: 30px;'>"):"");z.getMappingDatas().forEach(function(A){w+="<tr><td>"+A.getMappingName()+"</td><td>"+A.getConditionName()+"</td><td>"+A.getMapValue()+"</td></tr>"});w+="</table>";if(z.getSvg()!=undefined&&z.getSvg()!="undefined"){w+='<br/><img src="resources/images/structure_metabolite/'+z.getSvg()+'"/>'}document.getElementById("tooltip2").innerHTML=w;document.getElementById("tooltip2").classList.remove("hide")}).on("mouseleave",function(x){d3.select(this).attr("transform","translate("+x.x+", "+x.y+") scale(1)");if(!x.isSelected()){x.fixed=false}var w=metExploreD3.getLinkStyle();document.getElementById("tooltip2").classList.add("hide");d3.select("#"+k).select("#D3viz").select("#graphComponent").selectAll("line").filter(function(y){return x.getId()==y.getSource().getId()||x.getId()==y.getTarget().getId()}).style("stroke",w.getStrokeColor());if(x.getBiologicalType()=="reaction"){d3.select(this).selectAll("rect").selectAll(".reaction, .fontSelected").transition().duration(750).attr("width",reactionStyle.getWidth()).attr("height",reactionStyle.getHeight()).attr("transform","translate(-"+reactionStyle.getWidth()/2+",-"+reactionStyle.getHeight()/2+")")}else{d3.select(this).selectAll("rect").selectAll(".reaction, .fontSelected").transition().duration(750).attr("width",t.getWidth()).attr("height",t.getHeight()).attr("transform","translate(-"+t.getWidth()/2+",-"+t.getHeight()/2+")")}});var v=q.filter(function(w){return w.getId()==d});metExploreD3.GraphNode.colorStoreByCompartment(v);if(e.getNodes().length<r.getReactionThreshold()||!r.isDisplayedLabelsForOpt()){var l=Math.min(t.getWidth()/2,t.getHeight()/2);q.filter(function(w){return w.getId()==d}).filter(function(w){return w.getLabelVisible()==true}).filter(function(w){return w.getBiologicalType()=="metabolite"}).filter(function(w){return w.getSvg()=="undefined"}).append("svg:text").attr("fill","black").attr("class",function(w){return w.getBiologicalType()}).text(function(w){return $("<div/>").html(w.getName()).text()}).style("font-size",function(w){return Math.min((2*l/2),(2*l/2-3)/this.getComputedTextLength()*10)+"px"}).attr("dy",".3em").style("pointer-events","none").style("opacity",0.5);q.filter(function(w){return w.getId()==d}).filter(function(w){return w.getLabelVisible()==true}).filter(function(w){return w.getBiologicalType()=="metabolite"}).filter(function(w){return w.getSvg()!="undefined"}).append("svg:text").attr("fill","black").attr("class",function(w){return w.getBiologicalType()}).text(function(w){return $("<div/>").html(w.getName()).text()}).style("font-size",function(w){return Math.min((l)/2,((l-3)/this.getComputedTextLength()*10)/2)+"px"}).attr("dy",".3em").style("pointer-events","none").attr("y",+(3/4*(l/2)));q.filter(function(w){return w.getId()==d}).filter(function(w){return(w.getBiologicalType()=="metabolite"&&w.getSvg()!="undefined")}).append("svg").attr("viewBox",function(w){return"0 0 "+l+" "+l}).attr("width",l*8/10+"px").attr("height",l*8/10+"px").attr("x",(-l/2)+(l*1/10)).attr("preserveAspectRatio","xMinYMin").attr("y",(-l/2)+(l*1/10)).attr("class","structure_metabolite").append("image").style("opacity",0.5).attr("xlink:href",function(w){return"resources/images/structure_metabolite/"+w.getSvg()}).attr("width","100%").attr("height","100%");q.filter(function(w){return w.getId()==d}).filter(function(w){return w.getLabelVisible()==true}).filter(function(w){return w.getBiologicalType()=="reaction"}).append("svg:text").attr("fill","black").attr("class",function(w){return w.getBiologicalType()}).text(function(w){return $("<div/>").html(w.getName()).text()}).style("font-size",function(w){return Math.min(2*l,(l-2)/this.getComputedTextLength()*10)+"px"}).attr("dy",".3em")}if(m!=undefined&&m!=false&&m!="false"){if(m==true||m=="true"){q.filter(function(w){return w.getId()==d}).attr("mapped","true").insert("rect",":first-child").attr("class","stroke").attr("width",t.getWidth()/2+10).attr("height",t.getHeight()/2+10).attr("rx",t.getRX()/2+5).attr("ry",t.getRY()/2+5).attr("transform","translate(-"+parseInt(t.getWidth()/2+10)/2+",-"+parseInt(t.getWidth()/2+10)/2+")").style("opacity","0.5").style("fill","red")}else{var s=m;q.filter(function(w){return w.getId()==d}).attr("mapped",s).style("fill",s)}}var g=100;var f=100;q.filter(function(w){return w.getBiologicalType()=="reaction"}).filter(function(w){return w.getId()==h}).each(function(y){var x=y.x-j.x;var w=y.y-j.y;var z=Math.sqrt(Math.pow(x,2)+Math.pow(w,2));g=y.x-(40*x)/z;f=y.y-(40*w)/z});q.filter(function(w){return w.getBiologicalType()=="metabolite"}).filter(function(w){return w.getId()==d}).attr("transform",function(w){return"translate("+g+","+f+")"}).each(function(w){w.px=g;w.py=f;w.x=g;w.y=f});a.groups.forEach(function(w){if(w.key==c.getCompartment()){w.values.push(c)}});if(metExploreD3.GraphNetwork.isAnimated(k)==true||metExploreD3.GraphNetwork.isAnimated(k)=="true"){b.start()}return c},duplicateANode:function(h,b){var j=_metExploreViz.getSessionById(b);j.addDuplicatedNode(h.getId());var c=j.getForce();var g=j.getD3Data();var a,k;k=[];a=[];var d=d3.select("#"+b).select("#D3viz");var e=d3.behavior.drag().on("dragstart",function(l){_MyThisGraphNode.dragstart(l)}).on("drag",function(l){_MyThisGraphNode.dragmove(l)}).on("dragend",_MyThisGraphNode.dragend);var f=metExploreD3.getScaleById(b);d.selectAll("line.link").filter(function(l){return l.getInteraction()!="hiddenForce"}).each(function(n){var l=n.source;var m=n.target;if(l==h){a.push(m)}else{if(m==h){k.push(l)}}});a.forEach(function(n){var l=h.getId()+"-"+n.getId();var m=metExploreD3.GraphNetwork.addMetaboliteInDrawing(h,h.getId(),n.getId(),b);metExploreD3.GraphNetwork.addLinkInDrawing(l+"-"+n.getId(),m,n,"in",n.getReactionReversibility(),b)});k.forEach(function(n){var l=h.getId()+"-"+n.getId();var m=metExploreD3.GraphNetwork.addMetaboliteInDrawing(h,h.getId(),n.getId(),b);metExploreD3.GraphNetwork.addLinkInDrawing(n.getId()+"-"+l,n,m,"out",n.getReactionReversibility(),b)})},duplicateSideCompounds:function(b){var d=d3.select("#"+b).select("#D3viz");var c=[];var a=metExploreD3.createLoadMask("Duplicate in progress...",b);if(a!=undefined){metExploreD3.showMask(a);metExploreD3.deferFunction(function(){d.selectAll("g.node").filter(function(h){return h.getIsSideCompound()&&h.getBiologicalType()=="metabolite"}).filter(function(h){if(this.getAttribute("duplicated")==undefined){return true}else{return !this.getAttribute("duplicated")}}).each(function(h){metExploreD3.GraphNetwork.duplicateSideCompound(h,b);c.push(h)});metExploreD3.hideMask(a);c.forEach(function(h){metExploreD3.GraphNetwork.removeANode(h,b)});if(_metExploreViz.isLinkedByTypeOfMetabolite()){metExploreD3.GraphLink.linkTypeOfMetabolite()}var g=_metExploreViz.getSessionsSet();var e=_metExploreViz.getSessionById(b);if(b!="viz"&&e.isLinked()){metExploreD3.fireEvent("graphPanel","afterDuplicate")}else{for(var f in g){if(g[f].isLinked()&&g[f].getId()!="viz"){metExploreD3.deferFunction(function(){g[f].setLinked(false);metExploreD3.GraphNetwork.looksLinked();var j=g[f].getForce();var h=_metExploreViz.getSessionById("viz");if(g[f]!=undefined){if(h.getDuplicatedNodesCount()>0){var j=g[f].getForce();g[f].setLinked(true);h.setLinked(true);metExploreD3.GraphNetwork.duplicateSideCompounds(g[f].getId());metExploreD3.GraphNetwork.looksLinked();if(g[f].isLinked()){metExploreD3.GraphNetwork.graphAlignment(g[f].getId())}}else{metExploreD3.GraphNetwork.graphAlignment(g[f].getId());g[f].setLinked(true);h.setLinked(true)}}},100)}}}},0)}},duplicateSideCompoundsById:function(c,b){var e=d3.select("#"+b).select("#D3viz");var d=[];var a=metExploreD3.createLoadMask("Duplicate in progress...",b);if(a!=undefined){metExploreD3.showMask(a);metExploreD3.deferFunction(function(){e.selectAll("g.node").filter(function(f){return c.indexOf(f.getId())!=-1}).filter(function(f){if(this.getAttribute("duplicated")==undefined){return true}else{return !this.getAttribute("duplicated")}}).each(function(f){metExploreD3.GraphNetwork.duplicateSideCompound(f,b);d.push(f)});metExploreD3.hideMask(a);d.forEach(function(f){metExploreD3.GraphNetwork.removeANode(f,b)});if(_metExploreViz.isLinkedByTypeOfMetabolite()){metExploreD3.GraphLink.linkTypeOfMetabolite()}},0)}},duplicateSideCompoundsSelected:function(b){var d=d3.select("#"+b).select("#D3viz");var c=[];var a=metExploreD3.createLoadMask("Duplicate in progress...",b);if(a!=undefined){metExploreD3.showMask(a);metExploreD3.deferFunction(function(){d.selectAll("g.node").filter(function(h){return h.isSelected()&&h.getBiologicalType()=="metabolite"}).filter(function(h){if(this.getAttribute("duplicated")==undefined){return true}else{return !this.getAttribute("duplicated")}}).each(function(j){if(metExploreD3.getMetabolitesSet()!=undefined){var h=metExploreD3.getMetaboliteById(metExploreD3.getMetabolitesSet(),j.getId());h.set("sideCompound",true)}j.setIsSideCompound(true);metExploreD3.GraphNetwork.duplicateSideCompound(j,b);c.push(j)});metExploreD3.hideMask(a);c.forEach(function(h){metExploreD3.GraphNetwork.removeANode(h,b)});if(_metExploreViz.isLinkedByTypeOfMetabolite()){metExploreD3.GraphLink.linkTypeOfMetabolite()}var g=_metExploreViz.getSessionsSet();var e=_metExploreViz.getSessionById(b);if(b!="viz"&&e.isLinked()){metExploreD3.fireEvent("graphPanel","afterDuplicate")}else{for(var f in g){if(g[f].isLinked()&&g[f].getId()!="viz"){metExploreD3.deferFunction(function(){g[f].setLinked(false);metExploreD3.GraphNetwork.looksLinked();var j=g[f].getForce();var h=_metExploreViz.getSessionById("viz");if(g[f]!=undefined){if(h.getDuplicatedNodesCount()>0){var j=g[f].getForce();g[f].setLinked(true);h.setLinked(true);metExploreD3.GraphNetwork.duplicateSideCompoundsSelected(g[f].getId());metExploreD3.GraphNetwork.looksLinked();if(g[f].isLinked()){metExploreD3.GraphNetwork.graphAlignment(g[f].getId())}}else{metExploreD3.GraphNetwork.graphAlignment(g[f].getId());g[f].setLinked(true);h.setLinked(true)}}},100)}}}},0)}},duplicateASideCompoundSelected:function(e,b){var d=d3.select("#"+b).select("#D3viz");var c=[];var a=metExploreD3.createLoadMask("Duplicate in progress...",b);if(a!=undefined){metExploreD3.showMask(a);metExploreD3.deferFunction(function(){d.selectAll("g.node").filter(function(j){if(e.querySelector("rect.metabolite")!=null){return j.getId()==e.querySelector("rect.metabolite").id&&j.isSelected()&&j.getBiologicalType()=="metabolite"}else{return false}}).filter(function(j){if(this.getAttribute("duplicated")==undefined){return true}else{return !this.getAttribute("duplicated")}}).each(function(k){if(metExploreD3.getMetabolitesSet()!=undefined){var j=metExploreD3.getMetaboliteById(metExploreD3.getMetabolitesSet(),k.getId());j.set("sideCompound",true)}k.setIsSideCompound(true);metExploreD3.GraphNetwork.duplicateSideCompound(k,b);c.push(k)});metExploreD3.hideMask(a);c.forEach(function(j){metExploreD3.GraphNetwork.removeANode(j,b)});if(_metExploreViz.isLinkedByTypeOfMetabolite()){metExploreD3.GraphLink.linkTypeOfMetabolite()}var h=_metExploreViz.getSessionsSet();var f=_metExploreViz.getSessionById(b);if(b!="viz"&&f.isLinked()){metExploreD3.fireEvent("graphPanel","afterDuplicate")}else{for(var g in h){if(h[g].isLinked()&&h[g].getId()!="viz"){metExploreD3.deferFunction(function(){h[g].setLinked(false);metExploreD3.GraphNetwork.looksLinked();var k=h[g].getForce();var j=_metExploreViz.getSessionById("viz");if(h[g]!=undefined){if(j.getDuplicatedNodesCount()>0){var k=h[g].getForce();h[g].setLinked(true);j.setLinked(true);metExploreD3.GraphNetwork.duplicateASideCompoundSelected(e,h[g].getId());metExploreD3.GraphNetwork.looksLinked();if(h[g].isLinked()){metExploreD3.GraphNetwork.graphAlignment(h[g].getId())}}else{metExploreD3.GraphNetwork.graphAlignment(h[g].getId());h[g].setLinked(true);j.setLinked(true)}}},100)}}}},0)}},duplicateSideCompound:function(d,a){var e=_metExploreViz.getSessionById(a);var c=d3.select("#"+a).select("#D3viz");if(e!=undefined){if(e.isLinked()){var e=_metExploreViz.getSessionById("viz");if(e!=undefined){var b=e.getForce();if(b!=undefined){if(metExploreD3.GraphNetwork.isAnimated("viz")=="true"||metExploreD3.GraphNetwork.isAnimated("viz")==true){b.resume()}}}}else{var b=e.getForce();if(b!=undefined){if(metExploreD3.GraphNetwork.isAnimated(a)=="true"||metExploreD3.GraphNetwork.isAnimated(a)==true){b.resume()}}}}metExploreD3.GraphNetwork.duplicateANode(d,a);if(e!=undefined){if(b!=undefined){if(metExploreD3.GraphNetwork.isAnimated(a)=="true"||metExploreD3.GraphNetwork.isAnimated(a)==true){b.start()}}}},removeSelectedNode:function(b){var e=_metExploreViz.getSessionById(b);var d=e.getForce();var c=e.getD3Data();var a=metExploreD3.createLoadMask("Remove in process...",b);if(a!=undefined){metExploreD3.showMask(a);metExploreD3.deferFunction(function(){var g=d3.select("#"+b).select("#D3viz");if(h!=undefined){if(h.isLinked()){var h=_metExploreViz.getSessionById("viz");if(h!=undefined){var f=h.getForce();if(f!=undefined){if(metExploreD3.GraphNetwork.isAnimated("viz")=="true"){f.stop()}}}}else{var f=h.getForce();if(f!=undefined){if(metExploreD3.GraphNetwork.isAnimated(b)=="true"){f.stop()}}}}g.selectAll("g.node").filter(function(j){return j.isSelected()}).each(function(j){metExploreD3.GraphNetwork.removeANode(j,b)});metExploreD3.hideMask(a);metExploreD3.GraphNetwork.removeIsolatedNode(b);if(h!=undefined){if(f!=undefined){if(metExploreD3.GraphNetwork.isAnimated(b)=="true"){f.start()}}}},100)}},removeOnlyClickedNode:function(f,b){var e=_metExploreViz.getSessionById(b);var d=e.getForce();var c=e.getD3Data();var a=metExploreD3.createLoadMask("Remove in process...",b);if(a!=undefined){metExploreD3.showMask(a);metExploreD3.deferFunction(function(){var h=d3.select("#"+b).select("#D3viz");if(j!=undefined){if(j.isLinked()){var j=metExploreD3.getSessionById(sessionsStore,"viz");if(j!=undefined){var g=j.getForce();if(g!=undefined){if(metExploreD3.GraphNetwork.isAnimated("viz")=="true"){g.resume()}}}}else{var g=j.getForce();if(g!=undefined){if(metExploreD3.GraphNetwork.isAnimated(b)=="true"){g.resume()}}}}metExploreD3.GraphNetwork.removeASelectedNode(f,b);metExploreD3.GraphNetwork.removeIsolatedNode(b);if(j!=undefined){if(g!=undefined){if(metExploreD3.GraphNetwork.isAnimated(b)=="true"){g.start()}}}metExploreD3.hideMask(a);metExploreD3.GraphNetwork.removeIsolatedNode(b)},100)}},removeASelectedNode:function(e,b){var f=_metExploreViz.getSessionById(b);var a=metExploreD3.createLoadMask("Remove in process...",b);if(a!=undefined){metExploreD3.showMask(a);var d=d3.select("#"+b).select("#D3viz");if(f!=undefined){if(f.isLinked()){var f=metExploreD3.getSessionById(sessionsStore,"viz");if(f!=undefined){var c=f.getForce();if(c!=undefined){if(metExploreD3.GraphNetwork.isAnimated("viz")=="true"){c.resume()}}}}else{var c=f.getForce();if(c!=undefined){if(metExploreD3.GraphNetwork.isAnimated(b)=="true"){c.resume()}}}}metExploreD3.GraphNetwork.removeANode(e,b);if(f!=undefined){if(c!=undefined){if(metExploreD3.GraphNetwork.isAnimated("viz")=="true"){c.start()}}}metExploreD3.hideMask(a)}},removeANode:function(h,a){var j=_metExploreViz.getSessionById(a);var c=j.getForce();var e=j.getD3Data();var f=[];var d=d3.select("#"+a).select("#D3viz");j.groups.forEach(function(m){if(m.key==h.getCompartment()){var l=m.values.indexOf(h);if(l!=-1){m.values.splice(l,1)}}});d.selectAll("line.link").filter(function(n){var l=n.source;var m=n.target;return(l==h||m==h)}).remove();var b=d.selectAll("g.node");b.filter(function(l){return h==l}).transition().duration(1000).style("opacity",0).remove();var k=j.getSelectedNodes();var g=k.indexOf(h.getId());if(g!=-1){k.splice(g,1)}setTimeout(function(){for(i=0;i<e.getLinks().length;i++){var p=e.getLink(i);var n=p.source;var o=p.target;if(n==h||o==h){f.push(p)}}j.groups.forEach(function(r){if(r.key==h.getCompartment()){var q=r.values.indexOf(h);if(q!=-1){r.values.splice(q,1)}if(r.values.length==0){q=j.groups.indexOf(r);if(q!=-1){j.groups.splice(q,1);d3.select("#"+a).select("#D3viz").select("path#"+r.key).remove()}}}});var l=c.nodes().indexOf(h);if(l!=-1){c.nodes().splice(l,1)}for(i=0;i<f.length;i++){var m=f[i];var l=c.links().indexOf(m);if(l!=-1){c.links().splice(l,1)}}},10)},removeIsolatedNode:function(b){var g=_metExploreViz.getSessionById(b);var f=g.getForce();var e=g.getD3Data();var a=[];var d=d3.select("#"+b).select("#D3viz");var c=d.selectAll("g.node");c.filter(function(j){var h=false;d.selectAll("line.link").each(function(k){var l=k.source;var m=k.target;if(l.getId()==j.getId()||m.getId()==j.getId()){h=true}});if(!h){a.push(j)}return !h}).transition().duration(1000).style("opacity",0).remove();setTimeout(function(){for(i=0;i<a.length;i++){var j=a[i];g.groups.forEach(function(l){if(l.key==j.getCompartment()){var k=l.values.indexOf(j);if(k!=-1){l.values.splice(k,1)}if(l.values.length==0){k=g.groups.indexOf(l);if(k!=-1){g.groups.splice(k,1);d3.select("#"+b).select("#D3viz").select("path#"+l.key).remove()}}}});var h=f.nodes().indexOf(j);if(h!=-1){f.nodes().splice(h,1)}}for(i=0;i<a.length;i++){var j=a[i];var h=f.nodes().indexOf(j);if(h!=-1){f.nodes().splice(h,1)}}},10)},removeSideCompounds:function(){var a=d3.select("#viz").select("#D3viz");a.selectAll("g.node").filter(function(b){return b.getBiologicalType()=="metabolite"&&b.getIsSideCompound()}).each(function(b){metExploreD3.GraphNetwork.removeASelectedNode(b,"viz")});metExploreD3.GraphNetwork.removeIsolatedNode("viz")},setAnimated:function(a,b){if(b){d3.select("#"+a).select("#D3viz").attr("animation","true");_metExploreViz.getSessionById(a).setAnimated(true)}else{d3.select("#"+a).select("#D3viz").attr("animation","false");_metExploreViz.getSessionById(a).setAnimated(false)}},isAnimated:function(a){return d3.select("#"+a).select("#D3viz").attr("animation")},selectAllNodes:function(a){return d3.select("#"+a).select("#D3viz").selectAll("g.node")},stopForce:function(b){var a=b.getForce();if(a!=undefined){a.stop();metExploreD3.GraphNetwork.setAnimated(b.getId(),false)}},loadSvg:function(g,l){var n=parseInt(metExploreD3.GraphPanel.getHeight(l));var j=parseInt(metExploreD3.GraphPanel.getWidth(l));var q=metExploreD3.getLinkStyle();var b=g.getForce();var s=metExploreD3.getScaleById(l);metExploreD3.GraphCaption.drawCaption();if(s==undefined){var f=metExploreD3.GraphNetwork;metExploreD3.GraphNetwork.zoomListener=d3.behavior.zoom().x(t).y(d).scaleExtent([0.01,30]).on("zoom",function(u){var h=_metExploreViz.getSessionById(l);if(h.isActive()){f.zoom(l)}});s.add({graphName:l,xScale:t,yScale:d,zoomScale:1,xScaleCompare:1,yScaleCompare:1,zoomScaleCompare:metExploreD3.GraphNetwork.zoomListener.scale(),zoom:metExploreD3.GraphNetwork.zoomListener})}else{var f=metExploreD3.GraphNetwork;var t=d3.scale.linear().domain([0,j]).range([0,j]);var d=d3.scale.linear().domain([n,0]).range([n,0]);metExploreD3.GraphNetwork.zoomListener=d3.behavior.zoom().x(t).y(d).scaleExtent([0.01,30]).on("zoom",function(u){var h=_metExploreViz.getSessionById(this.parentNode.id);if(h.isActive()){f.zoom(this.parentNode.id)}});s.setScale(t,d,1,1,1,metExploreD3.GraphNetwork.zoomListener.scale(),metExploreD3.GraphNetwork.zoomListener)}var m=d3.select("#"+l);m.svg=m.select("#D3viz").selectAll("*").remove();var p;var e=false;var c=d3.select("#"+l).select("#D3viz").append("g").datum(function(){return{selected:false,previouslySelected:false}}).attr("id","brush").attr("class","brush").call(d3.svg.brush().x(t).y(d).on("brushstart",function(w){var u=d3.select("#"+l).select("#buttonHand").attr("scrollable");_MyThisGraphNode.activePanel=this.parentNode.parentNode.id;var v=_metExploreViz.getSessionById(_MyThisGraphNode.activePanel);if(d3.event.sourceEvent.button!=1&&u!="true"){if(v!=undefined){if(v.isLinked()){var x=_metExploreViz.getSessionById("viz");if(x!=undefined){var h=x.getForce();if(h!=undefined){h.stop()}}}else{var h=v.getForce();if(h!=undefined){h.stop()}}}e=true;d3.select("#"+l).select("#brush").classed("hide",false);d3.select("#"+l).select("#D3viz").on("mousedown.zoom",null);p=d3.select("#"+l).select("#graphComponent").selectAll("g.node");p.each(function(y){y.previouslySelected=y.isSelected()})}else{var h=v.getForce();if(h!=undefined){h.stop()}d3.select("#"+l).selectAll("#D3viz").style("cursor","all-scroll");d3.selectAll("#brush").classed("hide",true)}}).on("brushend",function(){if(d3.event.sourceEvent.button!=1&&e){var B=d3.event.target.extent();if(B[1][0]-B[0][0]>20||B[1][1]-B[0][1]>20){var y;var B=d3.event.target.extent();var v=metExploreD3.getScaleById(l);var x=v.getZoomScale();var u=metExploreD3.createLoadMask("Selection in progress...",l);if(u!=undefined){metExploreD3.showMask(u);metExploreD3.deferFunction(function(){p.classed("selected",function(I){var H=v.getXScale();var G=v.getYScale();y=(H(B[0][0])<=H(I.x)&&H(I.x)<H(B[1][0]))&&(G(B[0][1])<=G(I.y)&&G(I.y)<G(B[1][1]));if((I.isSelected()==false&&y==true)||(I.isSelected()==true&&y==false&&!I.previouslySelected)){_MyThisGraphNode.selection(I,l)}return y});metExploreD3.hideMask(u);var E=_metExploreViz.getSessionById(_MyThisGraphNode.activePanel);if(E!=undefined){if(E.isLinked()){var F=_metExploreViz.getSessionById("viz");if(F!=undefined){var C=metExploreD3.GraphNetwork.isAnimated(F.getId());if(C=="true"){var D=F.getForce();if(D!=undefined){if((metExploreD3.GraphNetwork.isAnimated(F.getId())=="true")||(metExploreD3.GraphNetwork.isAnimated(F.getId())==null)){D.start()}}}}}else{var D=E.getForce();var C=metExploreD3.GraphNetwork.isAnimated(E.getId());if(C=="true"){var D=E.getForce();if(D!=undefined){if((metExploreD3.GraphNetwork.isAnimated(E.getId())=="true")||(metExploreD3.GraphNetwork.isAnimated(E.getId())==null)){D.start()}}}}}e=false},100)}}d3.event.target.clear();d3.select(this).call(d3.event.target);var v=metExploreD3.getScaleById(l);d3.select("#"+l).selectAll("#D3viz").style("cursor","default");d3.select("#"+l).selectAll("#D3viz").call(v.getZoom()).on("dblclick.zoom",null).on("mousedown",null)}else{var z=_metExploreViz.getSessionById(_MyThisGraphNode.activePanel);if(z!=undefined){if(z.isLinked()){var w=_metExploreViz.getSessionById("viz");if(w!=undefined){var A=metExploreD3.GraphNetwork.isAnimated(w.getId());if(A=="true"){var h=w.getForce();if(h!=undefined){if((metExploreD3.GraphNetwork.isAnimated(w.getId())=="true")||(metExploreD3.GraphNetwork.isAnimated(w.getId())==null)){h.start()}}}}}else{var h=z.getForce();var A=metExploreD3.GraphNetwork.isAnimated(z.getId());if(A=="true"){var h=z.getForce();if(h!=undefined){if(d3.select(metExploreD3.GraphNetwork.isAnimated(z.getId())=="true")||(metExploreD3.GraphNetwork.isAnimated(z.getId())==null)){h.start()}}}}}}d3.event.target.clear();d3.select(this).call(d3.event.target);var v=metExploreD3.getScaleById(l);d3.select("#"+l).selectAll("#D3viz").style("cursor","default");d3.select("#"+l).selectAll("#D3viz").call(v.getZoom()).on("dblclick.zoom",null).on("mousedown",null);d3.event.target.extent();d3.selectAll("#brush").classed("hide",false)}));m.svg=d3.select("#"+l).select("#D3viz").call(metExploreD3.GraphNetwork.zoomListener).on("dblclick.zoom",null).attr("pointer-events","all").append("svg:g").attr("class","graphComponent").attr("id","graphComponent");var a=_metExploreViz.getSessionById(l);if(a!=undefined){var b=a.getForce();if(b!=undefined){b.stop();metExploreD3.GraphNetwork.setAnimated(l,false)}if(a.isResizable()!=undefined){metExploreD3.GraphNetwork.task.cancel()}a.setResizable(true);metExploreD3.GraphNetwork.task=metExploreD3.createDelayedTask(function(){a.setResizable(false)})}var o=false;d3.select("#"+l).select("#D3viz").attr("animation",function(){if(o){return"true"}else{return"false"}}).append("svg:g").attr("class","buttonAnim").attr("id","buttonAnim").on("click",metExploreD3.GraphNetwork.play).style("cursor","hand").append("image").attr("xlink:href",function(){if(o){return document.location.href.split("index.html")[0]+"resources/icons/pause.svg"}else{return document.location.href.split("index.html")[0]+"resources/icons/play.svg"}}).attr("width","50").attr("height","50").attr("transform","translate(10,10) scale(.5)");d3.select("#"+l).select("#D3viz").append("svg:g").attr("class","buttonZoomIn").attr("id","buttonZoomIn").attr("x",(j-60)).attr("y",10).on("click",metExploreD3.GraphNetwork.zoomIn).style("cursor","hand").append("image").attr("xlink:href",document.location.href.split("index.html")[0]+"resources/icons/zoomin.svg").attr("width","50").attr("height","50").style("opacity",0.2).attr("transform","translate("+(j-60)+",10) scale(1)").on("mouseover",function(h){d3.select(this).transition().duration(500).style("opacity",1)}).on("mouseout",function(h){d3.select(this).transition().duration(500).style("opacity",0.2)});d3.select("#"+l).select("#D3viz").append("svg:g").attr("class","buttonZoomOut").attr("id","buttonZoomOut").attr("x",(j-110)).attr("y",10).on("click",metExploreD3.GraphNetwork.zoomOut).style("cursor","hand").append("image").attr("xlink:href",document.location.href.split("index.html")[0]+"resources/icons/zoomout.svg").attr("width","50").attr("height","50").style("opacity",0.2).attr("transform","translate("+(j-110)+",10) scale(1)").on("mouseover",function(h){d3.select(this).transition().duration(500).style("opacity",1)}).on("mouseout",function(h){d3.select(this).transition().duration(500).style("opacity",0.2)});d3.select("#"+l).select("#D3viz").append("svg:g").attr("class","buttonHand").attr("id","buttonHand").attr("x",(j-160)).attr("y",10).attr("scrollable","false").on("click",metExploreD3.GraphNetwork.moveGraph).style("opacity",1).style("cursor","hand").append("image").attr("xlink:href",document.location.href.split("index.html")[0]+"resources/icons/handcursor.svg").attr("width","50").attr("height","50").attr("transform","translate("+(j-160)+",10) scale(1)");d3.select("#"+l).select("#D3viz").select("buttonHand").style("opacity",0);d3.select("#"+l).on("mouseover",function(){d3.select("#"+l).select("#D3viz").select("#buttonZoomOut").transition().duration(500).style("opacity",1);d3.select("#"+l).select("#D3viz").select("#buttonZoomIn").transition().duration(500).style("opacity",1);var u=_metExploreViz.getSessionById(l);if(u.isActive()){var h=d3.select("#"+l).select("#buttonHand").attr("scrollable");if(h=="false"){d3.select("#"+l).select("#D3viz").select("#buttonHand").transition().duration(500).style("opacity",0.2)}else{d3.select("#"+l).select("#D3viz").select("#buttonHand").transition().duration(500).style("opacity",1)}}}).on("mouseout",function(){d3.select("#"+l).select("#D3viz").select("#buttonZoomOut").transition().duration(500).style("opacity",0);d3.select("#"+l).select("#D3viz").select("#buttonZoomIn").transition().duration(500).style("opacity",0);d3.select("#"+l).select("#D3viz").select("#buttonHand").transition().duration(500).style("opacity",0)});var a=_metExploreViz.getSessionById(l);var q=metExploreD3.getLinkStyle();var r=metExploreD3.getMetaboliteStyle();metExploreD3.GraphLink.loadLink(l,a,q,r);metExploreD3.GraphNode.loadNode(l);var k=document.createElement("div");k.id="tooltip2";k.className="tooltip2";metExploreD3.GraphNetwork.looksLinked();if(a.isLinked()){metExploreD3.GraphNetwork.graphAlignment(l)}metExploreD3.GraphNetwork.tick(l)},loadSvgFromJSON:function(a){var k=parseInt(metExploreD3.GraphPanel.getHeight(a));var r=parseInt(metExploreD3.GraphPanel.getWidth(a));var j=metExploreD3.getLinkStyle();var d=d3.layout.force().friction(0.9).gravity(0.06).charge(-150).linkDistance(j.getSize()).size([r,k]);var p=metExploreD3.getSessionById(a);p.setActivity(true);p.setForce(d);if(a=="viz"){metExploreD3.GraphCaption.drawCaption()}var s=d3.scale.linear().domain([0,r]).range([0,r]);var f=d3.scale.linear().domain([k,0]).range([k,0]);if(metExploreD3.getScaleById(a)==undefined){var l=metExploreD3.GraphNetwork;metExploreD3.GraphNetwork.zoomListener=d3.behavior.zoom().x(s).y(f).scaleExtent([0.01,30]).on("zoom",function(t){var h=metExploreD3.getSessionById(a);if(h.isActive()){l.zoom(a)}});scale.add({graphName:a,xScale:s,yScale:f,zoomScale:1,xScaleCompare:1,yScaleCompare:1,zoomScaleCompare:metExploreD3.GraphNetwork.zoomListener.scale(),zoom:metExploreD3.GraphNetwork.zoomListener})}else{var l=metExploreD3.GraphNetwork;metExploreD3.GraphNetwork.zoomListener=d3.behavior.zoom().x(s).y(f).scaleExtent([0.01,30]).on("zoom",function(t){var h=metExploreD3.getSessionById(this.parentNode.id);if(h.isActive()){l.zoom(this.parentNode.id)}});scale.getStoreByGraphName(a).setScale(s,f,1,1,1,metExploreD3.GraphNetwork.zoomListener.scale(),metExploreD3.GraphNetwork.zoomListener)}var c=d3.select("#"+a);c.svg=c.select("#D3viz").selectAll("*").remove();var o;var e=false;var n=d3.select("#"+a).select("#D3viz").append("g").datum(function(){return{selected:false,previouslySelected:false}}).attr("id","brush").attr("class","brush").call(d3.svg.brush().x(s).y(f).on("brushstart",function(v){var t=d3.select("#"+a).select("#buttonHand").attr("scrollable");_MyThisGraphNode.activePanel=this.parentNode.parentNode.id;var u=_metExploreViz.getSessionById(_MyThisGraphNode.activePanel);if(d3.event.sourceEvent.button!=1&&t!="true"){if(u!=undefined){if(u.isLinked()){var w=_metExploreViz.getSessionById("viz");if(w!=undefined){var h=w.getForce();if(h!=undefined){h.stop()}}}else{var h=u.getForce();if(h!=undefined){h.stop()}}}e=true;d3.select("#"+a).select("#brush").classed("hide",false);d3.select("#"+a).select("#D3viz").on("mousedown.zoom",null);o=d3.select("#"+a).select("#graphComponent").selectAll("g.node");o.each(function(x){x.previouslySelected=x.isSelected()})}else{var h=u.getForce();if(h!=undefined){h.stop()}d3.select("#"+a).selectAll("#D3viz").style("cursor","all-scroll");d3.selectAll("#brush").classed("hide",true)}}).on("brushend",function(){if(d3.event.sourceEvent.button!=1&&e){var A=d3.event.target.extent();if(A[1][0]-A[0][0]>20||A[1][1]-A[0][1]>20){var x;var A=d3.event.target.extent();var u=metExploreD3.getScaleById(a);var w=u.getZoomScale();var t=metExploreD3.createLoadMask("Selection in progress...",a);if(t!=undefined){metExploreD3.showMask(t);metExploreD3.deferFunction(function(){o.classed("selected",function(H){var G=u.getXScale();var F=u.getYScale();x=(G(A[0][0])<=G(H.x)&&G(H.x)<G(A[1][0]))&&(F(A[0][1])<=F(H.y)&&F(H.y)<F(A[1][1]));if((H.isSelected()==false&&x==true)||(H.isSelected()==true&&x==false&&!H.previouslySelected)){_MyThisGraphNode.selection(H,a)}return x});metExploreD3.hideMask(t);var D=_metExploreViz.getSessionById(_MyThisGraphNode.activePanel);if(D!=undefined){if(D.isLinked()){var E=_metExploreViz.getSessionById("viz");if(E!=undefined){var B=metExploreD3.GraphNetwork.isAnimated(E.getId());if(B=="true"){var C=E.getForce();if(C!=undefined){if((metExploreD3.GraphNetwork.isAnimated(E.getId())=="true")||(metExploreD3.GraphNetwork.isAnimated(E.getId())==null)){C.start()}}}}}else{var C=D.getForce();var B=metExploreD3.GraphNetwork.isAnimated(D.getId());if(B=="true"){var C=D.getForce();if(C!=undefined){if((metExploreD3.GraphNetwork.isAnimated(D.getId())=="true")||(metExploreD3.GraphNetwork.isAnimated(D.getId())==null)){C.start()}}}}}e=false},100)}}d3.event.target.clear();d3.select(this).call(d3.event.target);var u=metExploreD3.getScaleById(a);d3.select("#"+a).selectAll("#D3viz").style("cursor","default");d3.select("#"+a).selectAll("#D3viz").call(u.getZoom()).on("dblclick.zoom",null).on("mousedown",null)}else{var y=_metExploreViz.getSessionById(_MyThisGraphNode.activePanel);if(y!=undefined){if(y.isLinked()){var v=_metExploreViz.getSessionById("viz");if(v!=undefined){var z=metExploreD3.GraphNetwork.isAnimated(v.getId());if(z=="true"){var h=v.getForce();if(h!=undefined){if((metExploreD3.GraphNetwork.isAnimated(v.getId())=="true")||(metExploreD3.GraphNetwork.isAnimated(v.getId())==null)){h.start()}}}}}else{var h=y.getForce();var z=metExploreD3.GraphNetwork.isAnimated(y.getId());if(z=="true"){var h=y.getForce();if(h!=undefined){if(d3.select(metExploreD3.GraphNetwork.isAnimated(y.getId())=="true")||(metExploreD3.GraphNetwork.isAnimated(y.getId())==null)){h.start()}}}}}}d3.event.target.clear();d3.select(this).call(d3.event.target);var u=metExploreD3.getScaleById(a);d3.select("#"+a).selectAll("#D3viz").style("cursor","default");d3.select("#"+a).selectAll("#D3viz").call(u.getZoom()).on("dblclick.zoom",null).on("mousedown",null);d3.event.target.extent();d3.selectAll("#brush").classed("hide",false)}));c.svg=d3.select("#"+a).select("#D3viz").call(metExploreD3.GraphNetwork.zoomListener).on("dblclick.zoom",null).attr("pointer-events","all").append("svg:g").attr("class","graphComponent").attr("id","graphComponent");var p=_metExploreViz.getSessionById(a);if(p!=undefined){var d=p.getForce();if(d!=undefined){d.stop();metExploreD3.GraphNetwork.setAnimated(a,false)}if(p.isResizable()!=undefined&&p.isResizable()!=false){metExploreD3.GraphNetwork.task.cancel()}p.setResizable(true);metExploreD3.GraphNetwork.task=metExploreD3.createDelayedTask(function(){p.setResizable(false)})}d3.select("#"+a).select("#D3viz").attr("animation","true").append("svg:g").attr("class","buttonAnim").attr("id","buttonAnim").on("click",metExploreD3.GraphNetwork.play).style("cursor","hand").append("image").attr("xlink:href",document.location.href.split("index.html")[0]+"resources/icons/pause.svg").attr("width","50").attr("height","50").attr("transform","translate(10,10) scale(.5)");d3.select("#"+a).select("#D3viz").append("svg:g").attr("class","buttonZoomIn").attr("id","buttonZoomIn").attr("x",(r-60)).attr("y",10).on("click",metExploreD3.GraphNetwork.zoomIn).style("cursor","hand").append("image").attr("xlink:href",document.location.href.split("index.html")[0]+"resources/icons/zoomin.svg").attr("width","50").attr("height","50").style("opacity",0.2).attr("transform","translate("+(r-60)+",10) scale(1)").on("mouseover",function(h){d3.select(this).transition().duration(500).style("opacity",1)}).on("mouseout",function(h){d3.select(this).transition().duration(500).style("opacity",0.2)});d3.select("#"+a).select("#D3viz").append("svg:g").attr("class","buttonZoomOut").attr("id","buttonZoomOut").attr("x",(r-110)).attr("y",10).on("click",metExploreD3.GraphNetwork.zoomOut).style("cursor","hand").append("image").attr("xlink:href",document.location.href.split("index.html")[0]+"resources/icons/zoomout.svg").attr("width","50").attr("height","50").style("opacity",0.2).attr("transform","translate("+(r-110)+",10) scale(1)").on("mouseover",function(h){d3.select(this).transition().duration(500).style("opacity",1)}).on("mouseout",function(h){d3.select(this).transition().duration(500).style("opacity",0.2)});d3.select("#"+a).select("#D3viz").append("svg:g").attr("class","buttonHand").attr("id","buttonHand").attr("x",(r-160)).attr("y",10).attr("scrollable","false").on("click",metExploreD3.GraphNetwork.moveGraph).style("opacity",1).style("cursor","hand").append("image").attr("xlink:href",document.location.href.split("index.html")[0]+"resources/icons/handcursor.svg").attr("width","50").attr("height","50").attr("transform","translate("+(r-160)+",10) scale(1)");d3.select("#"+a).select("#D3viz").select("buttonHand").style("opacity",0);d3.select("#"+a).on("mouseover",function(){d3.select("#"+a).select("#D3viz").select("#buttonZoomOut").transition().duration(500).style("opacity",1);d3.select("#"+a).select("#D3viz").select("#buttonZoomIn").transition().duration(500).style("opacity",1);var t=_metExploreViz.getSessionById(a);if(t.isActive()){var h=d3.select("#"+a).select("#buttonHand").attr("scrollable");if(h=="false"){d3.select("#"+a).select("#D3viz").select("#buttonHand").transition().duration(500).style("opacity",0.2)}else{d3.select("#"+a).select("#D3viz").select("#buttonHand").transition().duration(500).style("opacity",1)}}}).on("mouseout",function(){d3.select("#"+a).select("#D3viz").select("#buttonZoomOut").transition().duration(500).style("opacity",0);d3.select("#"+a).select("#D3viz").select("#buttonZoomIn").transition().duration(500).style("opacity",0);d3.select("#"+a).select("#D3viz").select("#buttonHand").transition().duration(500).style("opacity",0)});metExploreD3.GraphNetwork.setAnimated(a,true);var p=_metExploreViz.getSessionById(a);var j=metExploreD3.getLinkStyle();var m=metExploreD3.getMetaboliteStyle();metExploreD3.GraphLink.refreshLink(a,p,j,m);metExploreD3.GraphNode.refreshNode(a);var q=document.createElement("div");q.id="tooltip2";q.className="tooltip2";document.getElementById("viz").appendChild(q);var b=d3.select(l).attr("isLink");d3.select(l).select("image").remove();d3.select(l).append("image").attr("xlink:href",document.location.href.split("index.html")[0]+"resources/icons/link.svg").attr("width","50").attr("height","50").attr("transform","translate(10,50) scale(.5)");p.setLinked(false);if(a!="viz"){d3.select("#"+a).select("#D3viz").append("svg:g").attr("class","buttonLink").attr("id","buttonLink").attr("isLink","false").on("click",metExploreD3.GraphNetwork.setLink).style("cursor","hand").append("image").attr("xlink:href",document.location.href.split("index.html")[0]+"resources/icons/unlink.svg").attr("width","50").attr("height","50").attr("transform","translate(10,50) scale(.5)")}else{metExploreD3.GraphNetwork.looksLinked();if(p.isLinked()){metExploreD3.GraphNetwork.graphAlignment(a)}}var p=metExploreD3.getSessionById(a);var g=p.getD3Data();var d=p.getForce();d.nodes(g.getNodes()).links(g.getLinks()).on("tick",function(){if(d.alpha()>=0.005){setTimeout(metExploreD3.GraphNetwork.tick(a),0)}}).start();p.setForce(d)}};
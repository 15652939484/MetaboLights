webpackJsonp([1,4],{"+IhQ":function(e,t,n){"use strict";var i=n("Fzro");n.d(t,"b",function(){return s}),n.d(t,"a",function(){return r});var s=new i.d;s.append("Accept","application/json"),s.append("Content-Type","application/json"),s.append("user_token","");var r=new i.d;r.append("Accept","application/json")},0:function(e,t,n){e.exports=n("x35b")},"2eF6":function(e,t){e.exports='<div class="row" style="padding: 30px 30px 30px 30px;">\n  <div class="panel panel-default">\n    <div class="panel-heading">\n      <h6 class="panel-title">\n        <strong><span style="color:grey">{{studyID}} - </span></strong>\n        <span style="color:grey">{{title}}</span>\n      </h6>\n    </div>\n    <div class="panel-body">\n      <span style="color:grey">{{description}}</span>\n    </div>\n    <div class="panel-footer">\n      <a href="//ves-ebi-8d:8080/metabolights/{{studyID}}#orcidPopover" class="btn btn-default pull-center"\n         role="button" target="_blank"><span style="color:green;"><i style="height: 15px;\n    width: 15px;">\n                            <img src="//www.ebi.ac.uk/europepmc/thor/resources/orcid-id.png" value="What is ORCID?"\n                                 width="15" height="15" data-pin-nopin="true">\n                        </i><span *ngIf="claimed; else elseBlock"><i class="fa fa-check" aria-hidden="true"></i>&nbsp;Claimed</span>\n        <ng-template #elseBlock>&nbsp;Claim {{studyID}} to ORCID</ng-template>\n      </span></a>\n    </div>\n  </div>\n</div>\n'},"5xMp":function(e,t){e.exports='<div class="panel panel-info">\n  <div class="panel-heading">\n    <h5 class="panel-title">ORCID search\n    </h5>\n  </div>\n  <div class="panel-body">\n    <div class="row form-group">\n      <div class="col-md-6 col-xs-8">\n        <input type="text" class="form-control" [formControl]="searchEditForm.controls[\'searchterm\']"\n               [(ngModel)]="freeText"\n               name="freeText"\n               placeholder="Enter ORCID. Example: 0000-0001-8604-1732"\n               (keyup.enter)="onSearch(freeText)"\n               (keydown)="doUpdate()" (keyup)="doUpdate()" pattern="\\d\\d\\d\\d-\\d\\d\\d\\d-\\d\\d\\d\\d-\\d\\d\\d\\d">\n        <div *ngIf="searchEditForm.controls[\'searchterm\'].hasError(\'pattern\')" class="alert alert-danger">Invalid ORCID - Example: 0000-0001-8604-1732\n        </div>\n      </div>\n      <div class="col-md-6 col-xs-4">\n        <button type="button" class="btn btn-primary" (click)="onSearch(freeText)" [disabled]="!searchEditForm.valid">\n          Search <i\n          class="fa fa-search"></i>\n        </button>\n      </div>\n  </div>\n    \x3c!--<br>--\x3e\n    \x3c!--Batch claiming link--\x3e\n    \x3c!--<div class="col-md-4 col-xs-4">--\x3e\n      \x3c!--<a href="{{batchClaimURL}}" class="btn btn-default pull-center"--\x3e\n         \x3c!--role="button" target="_blank"><span style="color:green;"><i style="height: 15px;--\x3e\n    \x3c!--width: 15px;">--\x3e\n                            \x3c!--<img src="//www.ebi.ac.uk/europepmc/thor/resources/orcid-id.png" value="What is ORCID?"--\x3e\n                                 \x3c!--width="15" height="15" data-pin-nopin="true">--\x3e\n                        \x3c!--</i>&nbsp;Batch Claim studies to ORCID</span></a>--\x3e\n    \x3c!--</div>--\x3e\n\n    <br>\n\n    <div class="row" *ngIf="searching && !resolved">\n      <p align="center" class="text-primary"><label>Loading please wait </label> &nbsp;&nbsp; <i\n        class="fa fa-spinner fa-spin"\n        style="font-size:24px"></i>\n      </p>\n    </div>\n\n    <div class="row" *ngIf="noMTBLSButOtherResults">\n      <p align="center" class="text-primary"><label>No matching results found in MetaboLights.</label>\n      </p>\n      <br>\n      <p align="center">\n        <a href="//wwwdev.ebi.ac.uk/ebisearch/search.ebi?db=allebi&query={{freeText}}&requestFrom=searchBox"\n           class="btn btn-primary pull-center"\n           role="button" target="_blank"><span style="color:white;">Look up EMBL-EBI wide results</span></a>\n      </p>\n    </div>\n\n    <div class="row" *ngIf="noResults">\n      <p align="center" class="text-primary"><label>No results found. Please check your input!</label>\n      </p>\n    </div>\n\n    <div *ngIf="mtbls_ids.length > 0">\n      <template ngFor let-mtblsID [ngForOf]="mtbls_ids" let-i="index">\n        <app-mtbls-entry [studyID]=\'mtblsID\'></app-mtbls-entry>\n      </template>\n    </div>\n\n  </div>\n</div>\n\n\n'},Iksp:function(e,t,n){"use strict";var i=n("Qbdm"),s=n("3j3K"),r=n("NVOs"),o=n("Fzro"),a=n("YWx4"),c=n("jAa4");n.d(t,"a",function(){return d});var l=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},d=function(){function e(){}return e}();d=l([n.i(s.b)({declarations:[a.a,c.a],imports:[i.a,r.a,o.a,r.b,o.b],providers:[],bootstrap:[a.a]})],d)},MOVZ:function(e,t){function n(e){throw new Error("Cannot find module '"+e+"'.")}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="MOVZ"},YWx4:function(e,t,n){"use strict";var i=n("3j3K"),s=n("Fzro"),r=n("+pb+"),o=(n.n(r),n("NVOs")),a=n("+IhQ");n.d(t,"a",function(){return d});var c=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},d=function(){function e(e,t){this.http=e,this.searching=!1,this.resolved=!1,this.somethingWrong=!1,this.noResults=!1,this.noMTBLSButOtherResults=!1,this.orcidDevSearchURL="//wwwdev.ebi.ac.uk/ebisearch/ws/rest/europepmc?query=ORCID:",this.orcidSearchFormat="&format=json",this.pmidDevSearchURL="//wwwdev.ebi.ac.uk/ebisearch/ws/rest/europepmc/entry/",this.pmidSearchFormat="/xref/metabolights?format=json",this.batchClaimURL="//wwwdev.ebi.ac.uk/ebisearch/search.ebi?db=metabolights&query=domain_source:metabolights",this.mtblsISAEndpoint="http://ves-ebi-90:5000/mtbls/ws/study/",this.apiToken=localStorage.getItem("apiToken"),this.mtbls_ids=[],this.title="",this.description="",this.freeText="",this.orcidPatternRegex="dddd-dddd-dddd-dddd",this.ebiSearchResponse="",this.formBuilder=t,this.searchEditForm=this.formBuilder.group({searchterm:[this.freeText,o.c.compose([o.c.required,o.c.minLength(19)])]})}return e.prototype.onSearch=function(e){var t=this;this.searching=!0,this.isValid(e);var n=this.orcidDevSearchURL+e+"&start=0&size=99"+this.orcidSearchFormat;this.getSimpleRequest(n).subscribe(function(n){if(console.log(n),0!=n.length)if(n.hitCount>0){var i=t.extractPMIDS(n);t.searchForPMIDS(i,e)}else t.noResults=!0,t.resolved=!0},function(e){console.log(e),t.somethingWrong=!0})},e.prototype.searchForPMIDS=function(e,t){var n=this,i=this.constructSearchString(e),s=this.pmidDevSearchURL+i+this.pmidSearchFormat;this.getSimpleRequest(s).subscribe(function(e){console.log(e),0!=e.length?(n.ebiSearchResponse=e,n.queryMetabolights(t)):n.resolved=!0},function(e){console.log(e),n.somethingWrong=!0,n.resolved=!0})},e.prototype.doUpdate=function(){this.somethingWrong=!1,this.searching=!1,this.resolved=!1,this.mtbls_ids=[],this.noResults=!1,this.noMTBLSButOtherResults=!1},e.prototype.getSimpleRequest=function(e){return this.http.get(e,{headers:a.a}).map(function(e){return e.json()})},e.prototype.getRequest=function(e,t){return a.b.delete("user_token"),a.b.append("user_token",t),this.http.get(e,{headers:a.b}).map(function(e){return e.json()})},e.prototype.extractPMIDS=function(e){var t=e.entries,n=[];if(t.length>0)for(var i in t){var s=t[i].id;n.push(s)}return n},e.prototype.constructSearchString=function(e){var t="";if(1==e.length)return e[0];for(var n in e)t+=e[n]+",";return t=t.slice(0,-1)},e.prototype.extractMtblsIDs=function(e){var t=e.entries;for(var n in t){var i=t[n].references;if(i.length>0)for(var s in i){var r=i[s].id;this.mtbls_ids.push(r)}}0==this.mtbls_ids.length&&(this.noMTBLSButOtherResults=!0),this.resolved=!0},e.prototype.getStudyTitle=function(e){var t=this,n=this.mtblsISAEndpoint+e+"/title";this.getRequest(n,this.apiToken).subscribe(function(e){t.title=e["Study-title"]},function(e){console.log(e)})},e.prototype.getStudyDescription=function(e){var t=this,n=this.mtblsISAEndpoint+e+"/description";this.getRequest(n,this.apiToken).subscribe(function(e){t.description=e["Study-description"]},function(e){console.log(e)})},e.prototype.isValid=function(e){return e.match(this.orcidPatternRegex)},e.prototype.queryMetabolights=function(e){var t=this,n="http://wwwdev.ebi.ac.uk/ebisearch/ws/rest/metabolights?query=ORCID:"+e+"&format=json";this.getSimpleRequest(n).subscribe(function(e){if(t.extractMtblsIDs(t.ebiSearchResponse),0!=e.hitCount){var n=e.entries;for(var i in n){var s=n[i].id;console.log("from ML search = "+s);t.mtbls_ids.indexOf(s)>-1||t.mtbls_ids.push(s)}}},function(e){console.log(e)})},e}();d=c([n.i(i._5)({selector:"mtbls-adv-search",template:n("5xMp"),styles:[n("okgc")]}),l("design:paramtypes",["function"==typeof(p=void 0!==s.c&&s.c)&&p||Object,"function"==typeof(u=void 0!==o.d&&o.d)&&u||Object])],d);var p,u},jAa4:function(e,t,n){"use strict";var i=n("3j3K"),s=n("Fzro"),r=n("+IhQ");n.d(t,"a",function(){return c});var o=this&&this.__decorate||function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},c=function(){function e(e){this.http=e,this.claimed=!1}return e.prototype.ngOnInit=function(){this.getTitle(this.studyID),this.getDescription(this.studyID),this.isClaimedToORCID(this.studyID)},e.prototype.getTitle=function(e){var t=this,n="//wwwdev.ebi.ac.uk/ebisearch/ws/rest/metabolights?query=id:"+e+"&fields=id,name&format=json";this.getSimpleRequest(n).subscribe(function(e){if(1==e.hitCount){var n=e.entries;for(var i in n){var s=n[i],r=s.fields.name;r.length>0&&(t.title=r[0])}}},function(e){console.log(e)})},e.prototype.getDescription=function(e){var t=this,n="//wwwdev.ebi.ac.uk/ebisearch/ws/rest/metabolights?query=id:"+e+"&fields=id,description&format=json";this.getSimpleRequest(n).subscribe(function(e){if(1==e.hitCount){var n=e.entries;for(var i in n){var s=n[i],r=s.fields.description;r.length>0&&(t.description=r[0])}}},function(e){console.log(e)})},e.prototype.getSimpleRequest=function(e){return this.http.get(e,{headers:r.a}).map(function(e){return e.json()})},e.prototype.isClaimedToORCID=function(e){var t=this,n="//wwwdev.ebi.ac.uk/ebisearch/ws/rest/orcid_data_claims?query=METABOLIGHTS:"+this.studyID+"&format=JSON";this.getSimpleRequest(n).subscribe(function(e){0!=e.hitCount&&(t.claimed=!0)},function(e){console.log(e)})},e}();o([n.i(i.O)(),a("design:type",String)],c.prototype,"studyID",void 0),c=o([n.i(i._5)({selector:"app-mtbls-entry",template:n("2eF6"),styles:[n("nB0c")]}),a("design:paramtypes",["function"==typeof(l=void 0!==s.c&&s.c)&&l||Object])],c);var l},kZql:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i={production:!0}},nB0c:function(e,t,n){t=e.exports=n("FZ+f")(!1),t.push([e.i,"",""]),e.exports=e.exports.toString()},okgc:function(e,t,n){t=e.exports=n("FZ+f")(!1),t.push([e.i,"a{color:green}",""]),e.exports=e.exports.toString()},x35b:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("3j3K"),s=n("O61y"),r=n("Iksp");n("kZql").a.production&&n.i(i.a)(),n.i(s.a)().bootstrapModule(r.a)}},[0]);
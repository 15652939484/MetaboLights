webpackJsonp([1,4],{"+IhQ":function(t,e,n){"use strict";var i=n("Fzro");n.d(e,"b",function(){return s}),n.d(e,"a",function(){return r});var s=new i.d;s.append("Accept","application/json"),s.append("Content-Type","application/json"),s.append("user_token","");var r=new i.d;r.append("Accept","application/json")},0:function(t,e,n){t.exports=n("x35b")},"2eF6":function(t,e){t.exports='<div class="row" style="padding: 30px 30px 30px 30px;">\n  <div class="panel panel-default">\n    <div class="panel-heading">\n      <h6 class="panel-title">\n        <strong><span style="color:grey">{{studyID}} - </span></strong>\n        <span style="color:grey">{{title}}</span>\n      </h6>\n    </div>\n    <div class="panel-body">\n      <span style="color:grey">{{description}}</span>\n    </div>\n    <div class="panel-footer">\n      <a href="//ves-ebi-8d:8080/metabolights/{{studyID}}#orcidPopover" class="btn btn-default pull-center"\n         role="button" target="_blank"><span style="color:green;"><i style="height: 15px;\n    width: 15px;">\n                            <img src="//www.ebi.ac.uk/europepmc/thor/resources/orcid-id.png" value="What is ORCID?"\n                                 width="15" height="15" data-pin-nopin="true">\n                        </i><span *ngIf="claimed; else elseBlock"><i class="fa fa-check" aria-hidden="true"></i>&nbsp;Claimed</span>\n        <ng-template #elseBlock>&nbsp;Claim {{studyID}} to ORCID</ng-template>\n      </span></a>\n    </div>\n  </div>\n</div>\n'},"5xMp":function(t,e){t.exports='<div class="panel panel-info">\n  <div class="panel-heading">\n    <h5 class="panel-title">ORCID search\n    </h5>\n  </div>\n  <div class="panel-body">\n    <div class="row form-group">\n      <div class="col-md-6 col-xs-8">\n        <input type="text" class="form-control" [formControl]="searchEditForm.controls[\'searchterm\']"\n               [(ngModel)]="freeText"\n               name="freeText"\n               placeholder="Enter ORCID. Example: 0000-0001-8604-1732"\n               (keyup.enter)="onSearch(freeText)"\n               (keydown)="doUpdate()" (keyup)="doUpdate()" pattern="\\d\\d\\d\\d-\\d\\d\\d\\d-\\d\\d\\d\\d-\\d\\d\\d\\d">\n        <div *ngIf="searchEditForm.controls[\'searchterm\'].hasError(\'pattern\')" class="alert alert-danger">Invalid ORCID - Example: 0000-0001-8604-1732\n        </div>\n      </div>\n      <div class="col-md-6 col-xs-4">\n        <button type="button" class="btn btn-primary" (click)="onSearch(freeText)" [disabled]="!searchEditForm.valid">\n          Search <i\n          class="fa fa-search"></i>\n        </button>\n      </div>\n  </div>\n    \x3c!--<br>--\x3e\n    \x3c!--Batch claiming link--\x3e\n    \x3c!--<div class="col-md-4 col-xs-4">--\x3e\n      \x3c!--<a href="{{batchClaimURL}}" class="btn btn-default pull-center"--\x3e\n         \x3c!--role="button" target="_blank"><span style="color:green;"><i style="height: 15px;--\x3e\n    \x3c!--width: 15px;">--\x3e\n                            \x3c!--<img src="//www.ebi.ac.uk/europepmc/thor/resources/orcid-id.png" value="What is ORCID?"--\x3e\n                                 \x3c!--width="15" height="15" data-pin-nopin="true">--\x3e\n                        \x3c!--</i>&nbsp;Batch Claim studies to ORCID</span></a>--\x3e\n    \x3c!--</div>--\x3e\n\n    <br>\n\n    <div class="row" *ngIf="searching && !resolved">\n      <p align="center" class="text-primary"><label>Loading please wait </label> &nbsp;&nbsp; <i\n        class="fa fa-spinner fa-spin"\n        style="font-size:24px"></i>\n      </p>\n    </div>\n\n    <div class="row" *ngIf="noMTBLSButOtherResults">\n      <p align="center" class="text-primary"><label>No matching results found in MetaboLights.</label>\n      </p>\n      <br>\n      <p align="center">\n        <a href="https://www.ebi.ac.uk/ebisearch/search.ebi?db=allebi&query={{freeText}}&requestFrom=searchBox"\n           class="btn btn-primary pull-center"\n           role="button" target="_blank"><span style="color:white;">Look up EMBL-EBI wide results</span></a>\n      </p>\n    </div>\n\n    <div class="row" *ngIf="noResults">\n      <p align="center" class="text-primary"><label>No results found. Please check your input!</label>\n      </p>\n    </div>\n\n    <div *ngIf="mtbls_ids.length > 0">\n      <template ngFor let-mtblsID [ngForOf]="mtbls_ids" let-i="index">\n        <app-mtbls-entry [studyID]=\'mtblsID\'></app-mtbls-entry>\n      </template>\n    </div>\n\n  </div>\n</div>\n\n\n'},Iksp:function(t,e,n){"use strict";var i=n("Qbdm"),s=n("3j3K"),r=n("NVOs"),o=n("Fzro"),a=n("YWx4"),c=n("jAa4");n.d(e,"a",function(){return p});var l=this&&this.__decorate||function(t,e,n,i){var s,r=arguments.length,o=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,n,o):s(e,n))||o);return r>3&&o&&Object.defineProperty(e,n,o),o},p=function(){function t(){}return t}();p=l([n.i(s.b)({declarations:[a.a,c.a],imports:[i.a,r.a,o.a,r.b,o.b],providers:[],bootstrap:[a.a]})],p)},MOVZ:function(t,e){function n(t){throw new Error("Cannot find module '"+t+"'.")}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="MOVZ"},YWx4:function(t,e,n){"use strict";var i=n("3j3K"),s=n("Fzro"),r=n("+pb+"),o=(n.n(r),n("NVOs")),a=n("+IhQ");n.d(e,"a",function(){return p});var c=this&&this.__decorate||function(t,e,n,i){var s,r=arguments.length,o=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,n,o):s(e,n))||o);return r>3&&o&&Object.defineProperty(e,n,o),o},l=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},p=function(){function t(t,e){this.http=t,this.searching=!1,this.resolved=!1,this.somethingWrong=!1,this.noResults=!1,this.noMTBLSButOtherResults=!1,this.orcidDevSearchURL="https://www.ebi.ac.uk/ebisearch/ws/rest/europepmc?query=ORCID:",this.orcidSearchFormat="&format=json",this.pmidDevSearchURL="https://www.ebi.ac.uk/ebisearch/ws/rest/europepmc/entry/",this.pmidSearchFormat="/xref/metabolights?format=json",this.batchClaimURL="http://wwwdev.ebi.ac.uk/ebisearch/search.ebi?db=metabolights&query=domain_source:metabolights",this.mtblsISAEndpoint="http://ves-ebi-90:5000/mtbls/ws/study/",this.apiToken=localStorage.getItem("apiToken"),this.mtbls_ids=[],this.title="",this.description="",this.freeText="",this.orcidPatternRegex="dddd-dddd-dddd-dddd",this.ebiSearchResponse="",this.formBuilder=e,this.searchEditForm=this.formBuilder.group({searchterm:[this.freeText,o.c.compose([o.c.required,o.c.minLength(19)])]})}return t.prototype.onSearch=function(t){var e=this;this.searching=!0,this.isValid(t);var n=this.orcidDevSearchURL+t+"&start=0&size=99"+this.orcidSearchFormat;this.getSimpleRequest(n).subscribe(function(n){if(console.log(n),0!=n.length)if(n.hitCount>0){var i=e.extractPMIDS(n);e.searchForPMIDS(i,t)}else e.noResults=!0,e.resolved=!0},function(t){console.log(t),e.somethingWrong=!0})},t.prototype.searchForPMIDS=function(t,e){var n=this,i=this.constructSearchString(t),s=this.pmidDevSearchURL+i+this.pmidSearchFormat;this.getSimpleRequest(s).subscribe(function(t){console.log(t),0!=t.length?(n.ebiSearchResponse=t,n.queryMetabolights(e)):n.resolved=!0},function(t){console.log(t),n.somethingWrong=!0,n.resolved=!0})},t.prototype.doUpdate=function(){this.somethingWrong=!1,this.searching=!1,this.resolved=!1,this.mtbls_ids=[],this.noResults=!1,this.noMTBLSButOtherResults=!1},t.prototype.getSimpleRequest=function(t){return this.http.get(t,{headers:a.a}).map(function(t){return t.json()})},t.prototype.getRequest=function(t,e){return a.b.delete("user_token"),a.b.append("user_token",e),this.http.get(t,{headers:a.b}).map(function(t){return t.json()})},t.prototype.extractPMIDS=function(t){var e=t.entries,n=[];if(e.length>0)for(var i in e){var s=e[i].id;n.push(s)}return n},t.prototype.constructSearchString=function(t){var e="";if(1==t.length)return t[0];for(var n in t)e+=t[n]+",";return e=e.slice(0,-1)},t.prototype.extractMtblsIDs=function(t){var e=t.entries;for(var n in e){var i=e[n].references;if(i.length>0)for(var s in i){var r=i[s].id;this.mtbls_ids.push(r)}}0==this.mtbls_ids.length&&(this.noMTBLSButOtherResults=!0),this.resolved=!0},t.prototype.getStudyTitle=function(t){var e=this,n=this.mtblsISAEndpoint+t+"/title";this.getRequest(n,this.apiToken).subscribe(function(t){e.title=t["Study-title"]},function(t){console.log(t)})},t.prototype.getStudyDescription=function(t){var e=this,n=this.mtblsISAEndpoint+t+"/description";this.getRequest(n,this.apiToken).subscribe(function(t){e.description=t["Study-description"]},function(t){console.log(t)})},t.prototype.isValid=function(t){return t.match(this.orcidPatternRegex)},t.prototype.queryMetabolights=function(t){var e=this,n="http://wwwdev.ebi.ac.uk/ebisearch/ws/rest/metabolights?query=ORCID:"+t+"&format=json";this.getSimpleRequest(n).subscribe(function(t){if(e.extractMtblsIDs(e.ebiSearchResponse),0!=t.hitCount){var n=t.entries;for(var i in n){var s=n[i].id;console.log("from ML search = "+s);e.mtbls_ids.indexOf(s)>-1||e.mtbls_ids.push(s)}}},function(t){console.log(t)})},t}();p=c([n.i(i._5)({selector:"mtbls-adv-search",template:n("5xMp"),styles:[n("okgc")]}),l("design:paramtypes",["function"==typeof(d=void 0!==s.c&&s.c)&&d||Object,"function"==typeof(u=void 0!==o.d&&o.d)&&u||Object])],p);var d,u},jAa4:function(t,e,n){"use strict";var i=n("3j3K"),s=n("Fzro"),r=n("+IhQ");n.d(e,"a",function(){return c});var o=this&&this.__decorate||function(t,e,n,i){var s,r=arguments.length,o=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,n,o):s(e,n))||o);return r>3&&o&&Object.defineProperty(e,n,o),o},a=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},c=function(){function t(t){this.http=t,this.claimed=!1}return t.prototype.ngOnInit=function(){this.getTitle(this.studyID),this.getDescription(this.studyID),this.isClaimedToORCID(this.studyID)},t.prototype.getTitle=function(t){var e=this,n="http://wwwdev.ebi.ac.uk/ebisearch/ws/rest/metabolights?query=id:"+t+"&fields=id,name&format=json";this.getSimpleRequest(n).subscribe(function(t){if(1==t.hitCount){var n=t.entries;for(var i in n){var s=n[i],r=s.fields.name;r.length>0&&(e.title=r[0])}}},function(t){console.log(t)})},t.prototype.getDescription=function(t){var e=this,n="http://wwwdev.ebi.ac.uk/ebisearch/ws/rest/metabolights?query=id:"+t+"&fields=id,description&format=json";this.getSimpleRequest(n).subscribe(function(t){if(1==t.hitCount){var n=t.entries;for(var i in n){var s=n[i],r=s.fields.description;r.length>0&&(e.description=r[0])}}},function(t){console.log(t)})},t.prototype.getSimpleRequest=function(t){return this.http.get(t,{headers:r.a}).map(function(t){return t.json()})},t.prototype.isClaimedToORCID=function(t){var e=this,n="http://www.ebi.ac.uk/ebisearch/ws/rest/orcid_data_claims?query=METABOLIGHTS:"+this.studyID+"&format=JSON";this.getSimpleRequest(n).subscribe(function(t){0!=t.hitCount&&(e.claimed=!0)},function(t){console.log(t)})},t}();o([n.i(i.O)(),a("design:type",String)],c.prototype,"studyID",void 0),c=o([n.i(i._5)({selector:"app-mtbls-entry",template:n("2eF6"),styles:[n("nB0c")]}),a("design:paramtypes",["function"==typeof(l=void 0!==s.c&&s.c)&&l||Object])],c);var l},kZql:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i={production:!0}},nB0c:function(t,e,n){e=t.exports=n("FZ+f")(!1),e.push([t.i,"",""]),t.exports=t.exports.toString()},okgc:function(t,e,n){e=t.exports=n("FZ+f")(!1),e.push([t.i,"a{color:green}",""]),t.exports=t.exports.toString()},x35b:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("3j3K"),s=n("O61y"),r=n("Iksp");n("kZql").a.production&&n.i(i.a)(),n.i(s.a)().bootstrapModule(r.a)}},[0]);